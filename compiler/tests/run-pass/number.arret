(import [stdlib base])
(import [stdlib test])

(defn test-comparisons () ->! ()
  (assert-eq! true (< (black-box! -1)))
  (assert-eq! true (> (black-box! ##NaN)))

  ; NaNs always compare false
  (assert-eq! false (< (black-box! ##NaN) ##NaN))
  (assert-eq! false (<= ##NaN (black-box! ##NaN)))
  (assert-eq! false (== (black-box! ##NaN) (black-box! ##NaN)))

  (assert-eq! true (< 1 2.0 (black-box! 3)))
  (assert-eq! true (<= 1 (black-box! 2.0) 3))
  (assert-eq! false (== 1 (black-box! 2.0) (black-box! 3)))
  (assert-eq! false (> (black-box! 1) 2.0 3))
  (assert-eq! false (>= (black-box! 1) 2.0 (black-box! 3)))

  (assert-eq! false (< (black-box! 1) (black-box! 2) 2.0))
  (assert-eq! true (<= (black-box! 1) (black-box! 2) (black-box! 2.0)))

  (assert-eq! false (> (black-box! 2) (black-box! 2) 1.0))
  (assert-eq! true (>= (black-box! 2) (black-box! 2) (black-box! 1.0)))

  (assert-eq! true (== (black-box! 1) 1.0))
  (assert-eq! true (== 1 (black-box! 1.0)))
  (assert-eq! true (== (black-box! 1) (black-box! 1.0))))

(defn main! () ->! ()
  (test-comparisons))