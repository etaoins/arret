(import [stdlib base])
(import [stdlib test])

(defn test-add () ->! ()
  (assert-eq! 0 (+))
  (assert-eq! 4 (+ 4))

  (assert-eq! 7 (+ 4 3))
  (assert-eq! 7.0 (+ 4.0 3))
  (assert-eq! 7.0 (+ 4 3.0))
  (assert-eq! 7.0 (+ 4.0 3.0))

  (assert-eq! true (nan? (+ ##NaN)))
  (assert-eq! true (nan? (+ 1.0 ##NaN))))

(defn test-mul () ->! ()
  (assert-eq! 1 (*))
  (assert-eq! 4 (* 4))

  (assert-eq! 12 (* 4 3))
  (assert-eq! 12.0 (* 4.0 3))
  (assert-eq! 12.0 (* 4 3.0))
  (assert-eq! 12.0 (* 4.0 3.0))

  (assert-eq! true (nan? (* ##NaN)))
  (assert-eq! true (nan? (* 1.0 ##NaN))))

(defn test-sub () ->! ()
  (assert-eq! -3.0 (- 3.0))
  (assert-eq! 3 (- -3))

  (assert-eq! 4 (- 7 3))
  (assert-eq! 4.0 (- 7 3.0))
  (assert-eq! 4.0 (- 7.0 3))
  (assert-eq! 4.0 (- 7.0 3.0))

  (assert-eq! true (nan? (- ##NaN)))
  (assert-eq! true (nan? (- 1.0 ##NaN))))

(defn test-div () ->! ()
  (assert-eq! 1.0 (/ 1.0))
  (assert-eq! 0.5 (/ 2.0))
  (assert-eq! 0.25 (/ 1.0 2.0 2.0))

  (assert-eq! true (nan? (/ ##NaN)))
  (assert-eq! true (nan? (/ 1.0 ##NaN))))

(defn test-inc-dec () ->! ()
  (assert-eq! -1 (inc -2))
  (assert-eq! 0 (inc -1))
  (assert-eq! 1 (inc 0))
  (assert-eq! 2 (inc 1))

  (assert-eq! -2 (dec -1))
  (assert-eq! -1 (dec 0))
  (assert-eq! 0 (dec 1))
  (assert-eq! 1 (dec 2)))

(defn test-rem-mod () ->! ()
  (assert-eq! 3 (quot 10 3))
  (assert-eq! 1 (rem 10 3))

  (assert-eq! 3 (quot 11 3))
  (assert-eq! 2 (rem 11 3))

  (assert-eq! 4 (quot 11 3))
  (assert-eq! 0 (rem 11 3))

  (assert-eq! -3 (quot -10 3))
  (assert-eq! -1 (rem -10 3)))

(defn main! () ->! ()
  (test-add)
  (test-mul)
  (test-sub)
  (test-div)
  (test-inc-dec))