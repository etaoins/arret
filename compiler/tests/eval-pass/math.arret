(import [stdlib base])
(import [stdlib test])

(defn test-add ()
  (assert-eq 0 (+))
  (assert-eq 4 (+ 4))

  (assert-eq 7 (+ 4 3))
  (assert-eq 7.0 (+ 4.0 3))
  (assert-eq 7.0 (+ 4 3.0))
  (assert-eq 7.0 (+ 4.0 3.0))

  (assert-eq true (nan? (+ ##NaN)))
  (assert-eq true (nan? (+ 1.0 ##NaN)))

  ())

(defn test-mul ()
  (assert-eq 1 (*))
  (assert-eq 4 (* 4))

  (assert-eq 12 (* 4 3))
  (assert-eq 12.0 (* 4.0 3))
  (assert-eq 12.0 (* 4 3.0))
  (assert-eq 12.0 (* 4.0 3.0))

  (assert-eq true (nan? (* ##NaN)))
  (assert-eq true (nan? (* 1.0 ##NaN)))

  ())

(defn test-sub ()
  (assert-eq -3.0 (- 3.0))
  (assert-eq 3 (- -3))

  (assert-eq 4 (- 7 3))
  (assert-eq 4.0 (- 7 3.0))
  (assert-eq 4.0 (- 7.0 3))
  (assert-eq 4.0 (- 7.0 3.0))

  (assert-eq true (nan? (- ##NaN)))
  (assert-eq true (nan? (- 1.0 ##NaN)))

  ())

(defn test-div ()
  (assert-eq 1.0 (/ 1.0))
  (assert-eq 0.5 (/ 2.0))
  (assert-eq 0.25 (/ 1.0 2.0 2.0))

  (assert-eq true (nan? (/ ##NaN)))
  (assert-eq true (nan? (/ 1.0 ##NaN)))

  ())

(defn main! () ->! ()
  (test-add)
  (test-mul)
  (test-sub)
  (test-div)

  ())